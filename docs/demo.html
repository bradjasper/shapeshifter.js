<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="//unpkg.com/tachyons@4.12.0/css/tachyons.min.css" />
  <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.7.0/dist/alpine.min.js" defer></script>
  <script src="//unpkg.com/bsv@^2.0.0-beta"></script>
  <script src="../dist/shapeshifter.js"></script>
</head>
<body class="sans-serif">
  <div class="vh-100 flex flex-column" x-data="shifter()">
    <header class="flex items-center ph3 near-white bg-near-black">
      <div>LOGO</div>
      <div class="flex-auto pr3 f6 lh-copy tr">
        <span class="fw6">Convert to:</span>
        <label class="fw3 light-silver ml3">
          <input type="radio" class="mr1 v-mid" x-model="fmt" value="raw" />
          Raw
        </label>
        <label class="fw3 light-silver ml3">
          <input type="radio" class="mr1 v-mid" x-model="fmt" value="tx" />
          Tx
        </label>
        <label class="fw3 light-silver ml3">
          <input type="radio" class="mr1 v-mid" x-model="fmt" value="txo" />
          TXO
        </label>
        <label class="fw3 light-silver ml3">
          <input type="radio" class="mr1 v-mid" x-model="fmt" value="bob" />
          BOB
        </label>
      </div>
      <div class="pv2">
        <a class="dib pa2 link f5 lh-block fw6 i white bg-hot-pink pointer br2"
          x-on:click="shift()">Shift!</a>
      </div>
    </header>
    <main class="relative flex-auto bg-near-black">
      <div class="flex h-100 pt0 pb3">
        <div class="w-50 pl3 pr2">
          <textarea class="input-reset w-100 h-100 pa2 f6 code lh-copy near-white bg-dark-gray bn br2"
            placeholder="Paste source transaction here&hellip;"
            x-model="src"></textarea>
        </div>
        <div class="w-50 pl2 pr3">
          <div class="w-100 h-100 pa2 f5 code lh-copy near-white bg-dark-gray bn br2">
            <div class="pa2 bg-dark-red br1" x-show="err" x-text="err"></div>
            <pre class="w-100 h-100 ma0 f6 overflow-scroll" x-show="res" x-text="res"></pre>
          </div>
        </div>
      </div>
    </main>
  </div>

<script>
function shifter() {
  return {
    src: null,
    res: null,
    err: null,
    fmt: 'bob',

    shift() {
      let src, res
      this.err = null

      try {
        if (this.src.match(/^[a-f0-9]+$/i)) {
          src = this.src
        } else {
          eval('src='+this.src)
        }

        console.log(src)

        switch(this.fmt) {
          case 'raw':
            res = Shapeshifter.toHex(src)
            break
          case 'tx':
            res = Shapeshifter.toTx(src)
            break
          case 'txo':
            res = Shapeshifter.toTxo(src)
            break
          case 'bob':
            res = Shapeshifter.toBob(src)
            break
        }
        if (this.fmt === 'raw') {
          this.res = res
        } else {
          this.res = JSON.stringify(res, null, 2)
        }
      } catch(e) {
        console.log(e)
        this.err = e
      }
    }
  }
}
</script>
  
</body>
</html>